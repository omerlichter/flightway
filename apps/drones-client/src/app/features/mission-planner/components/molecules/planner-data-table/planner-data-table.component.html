<p-table
  class="data-table"
  styleClass="p-datatable-striped p-datatable-gridlines p-datatable-sm planner-data-table"
  [value]="$missionPointsDataTable()"
  [columns]="columns"
  [resizableColumns]="true"
  [reorderableColumns]="true"
  columnResizeMode="expand"
  [scrollable]="true"
  scrollHeight="flex"
  dataKey="id"
  editMode="row"
  (onRowReorder)="onUpdateTable()"
>
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th style="min-width: 40px; width: 40px" pFrozenColumn></th>
      <th style="width: 120px" pFrozenColumn></th>
      <th style="min-width: 40px; width: 40px">
        <div class="additional-data-container">#</div>
      </th>
      <th *ngFor="let col of columns" pResizableColumn>
        {{ col.header }}
      </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-rowData let-columns="columns" let-index="rowIndex" let-editing="editing">
    <tr [pEditableRow]="rowData" [pReorderableRow]="index">
      <td pFrozenColumn>
        <div class="additional-data-container">
          <span class="pi pi-bars" pReorderableRowHandle></span>
        </div>
      </td>
      <td pFrozenColumn>
        <div class="additional-data-container">
          @if (!editing) {
          <div>
            <button pButton type="button" pInitEditableRow icon="pi pi-pencil" [text]="true"></button>
            <button
              pButton
              type="button"
              icon="pi pi-trash"
              [text]="true"
              class="p-button-danger"
              (click)="onDeleteMissionPoint(index)"
            ></button>
          </div>
          } @else {
          <div>
            <button
              pButton
              type="button"
              pSaveEditableRow
              icon="pi pi-check"
              [text]="true"
              (click)="onEditMissionPoint(index, rowData)"
              class="p-button-success"
            ></button>
            <button
              pButton
              type="button"
              pCancelEditableRow
              icon="pi pi-times"
              [text]="true"
              class="p-button-danger"
            ></button>
          </div>
          }
        </div>
      </td>
      <td>
        <div class="additional-data-container">
          <span>{{ index }}</span>
        </div>
      </td>
      @for (col of columns; track $index) {
      <td>
        @if (col.editable) {
        <p-cellEditor>
          <ng-template pTemplate="input">
            <ng-container *ngComponentOutlet=""></ng-container>
            <app-planner-data-table-coord-field
              [value]="rowData[col.field]"
              [coordType]="'latitude'"
            ></app-planner-data-table-coord-field>
            <!-- <input class="p-inputtext-sm input-fit-container" pInputText type="number" [value]="rowData[col.field]" /> -->
          </ng-template>
          <ng-template pTemplate="output">
            {{ rowData[col.field] }}
          </ng-template>
        </p-cellEditor>
        } @else {
        {{ rowData[col.field] }}
        }
      </td>
      }
    </tr>
  </ng-template>
</p-table>
